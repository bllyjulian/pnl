<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Futures P&L & Liquidation Calculator</title>
  <style>
    :root{--bg:#0b1220;--card:#0f1724;--accent:#18A0FB;--muted:#9aa6b2;--success:#16a34a;--danger:#ef4444}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial; margin:0;background:linear-gradient(180deg,#071129 0%, #071827 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .card{background:var(--card);max-width:820px;width:100%;border-radius:12px;padding:22px;box-shadow:0 8px 30px rgba(2,6,23,.6)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
    input, select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,.06);background:#0b1520;color:inherit;font-size:15px}
    .full{grid-column:1/-1}
    .actions{display:flex;gap:8px;align-items:center;margin-top:10px}
    button{background:var(--accent);border:0;padding:10px 14px;border-radius:10px;color:#05202e;font-weight:600;cursor:pointer}
    button.secondary{background:transparent;border:1px solid rgba(255,255,255,.06);color:var(--muted)}
    .result{margin-top:18px;background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,.03)}
    .row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed rgba(255,255,255,.02)}
    .row:last-child{border-bottom:none}
    .muted{color:var(--muted);font-size:13px}
    .big{font-weight:700;font-size:18px}
    .green{color:var(--success)}
    .red{color:var(--danger)}
    footer{margin-top:12px;color:var(--muted);font-size:13px}
    @media(max-width:720px){.grid{grid-template-columns:1fr}.actions{flex-direction:column;align-items:stretch} .full{order:99}}
  </style>
</head>
<body>
  <div class="card">
    <h1>Futures P&L & Liquidation Calculator by Billyy.</h1>
    <p class="lead">Masukkan modal (USD), leverage, dan persen pergerakan koin. Pilih arah posisi (Long/Short). Kalkulator ini menampilkan P&L, nilai dalam rupiah, dan perkiraan liquidation.</p>

    <div class="grid">
      <div>
        <label>Modal (USD)</label>
        <input id="margin" type="number" min="0" step="0.01" value="1" />
      </div>

      <div>
        <label>Leverage (×)</label>
        <input id="leverage" type="number" min="1" step="1" value="25" />
      </div>

      <div>
        <label>Arah posisi</label>
        <select id="side">
          <option value="long">Long</option>
          <option value="short">Short</option>
        </select>
      </div>

      <div>
        <label>Pergerakan harga (%) — positif = naik, negatif = turun</label>
        <input id="priceChange" type="number" step="0.01" value="10" />
      </div>

      <div class="full">
        <label>Kurs USD ke IDR</label>
        <input id="kurs" type="number" step="1" value="15500" />
      </div>

      <div class="full">
        <label>Keterangan (opsional)</label>
        <input id="note" placeholder="misal: BTC naik 10%" />
      </div>

      <div class="full actions">
        <button id="calc">Hitung</button>
        <button class="secondary" id="reset">Reset</button>
      </div>
    </div>

    <div id="out" class="result" aria-live="polite">
      <div class="row"><div class="muted">Posisi (notional)</div><div id="notional" class="big">-</div></div>
      <div class="row"><div class="muted">P&L (USD)</div><div id="pnl" class="big">-</div></div>
      <div class="row"><div class="muted">P&L (% dari modal)</div><div id="pnlPct" class="big">-</div></div>
      <div class="row"><div class="muted">Saldo akhir (modal + P&L)</div><div id="finalBalance" class="big">-</div></div>
      <div class="row"><div class="muted">Total Pendapatan (IDR)</div><div id="netIdr" class="big">-</div></div>
      <div class="row"><div class="muted">Pendapatan Bersih (IDR)</div><div id="pnlIdr" class="big">-</div></div>
      <div class="row"><div class="muted">Perkiraan gerak ke Liquidation (gerak lawan arah)</div><div id="liqMove" class="big">-</div></div>
      <div class="row"><div class="muted">Margin maintenance estimate (approx)</div><div id="maint" class="big muted">-</div></div>
      <div class="row"><div class="muted">Catatan</div><div id="noteOut" class="muted">-</div></div>
    </div>

    <footer>Rumus dasar: Notional = margin × leverage. P&L = notional × (priceChange%). P&L% = (P&L / margin) × 100. Liquidation ≈ 100% / leverage (perkiraan sederhana).</footer>
  </div>

  <script>
    const el = id => document.getElementById(id);
    const fmt = n => (isFinite(n) ? new Intl.NumberFormat('en-US',{minimumFractionDigits:2,maximumFractionDigits:8}).format(n) : '-');

    function calc(){
      const margin = parseFloat(el('margin').value);
      const lev = parseFloat(el('leverage').value);
      const side = el('side').value;
      const change = parseFloat(el('priceChange').value);
      const kurs = parseFloat(el('kurs').value);
      const note = el('note').value || '-';

      if (!isFinite(margin) || margin <= 0){ alert('Masukkan modal valid (lebih dari 0).'); return; }
      if (!isFinite(lev) || lev <= 0){ alert('Masukkan leverage valid (>=1).'); return; }
      if (!isFinite(change)){ alert('Masukkan pergerakan harga yang valid.'); return; }
      if (!isFinite(kurs) || kurs <= 0){ alert('Masukkan kurs USD ke IDR yang valid.'); return; }

      const notional = margin * lev;
      const effectivePct = side === 'long' ? change : -change;

      const pnl = notional * (effectivePct / 100);
      const pnlPctOfMargin = (pnl / margin) * 100;
      const finalBalance = margin + pnl;
      const pnlIdr = pnl * kurs;
      const netIdr = finalBalance * kurs;

      const liqMove = 100 / lev;

      // Tampilkan hasil
      el('notional').textContent = '$' + fmt(notional);

      const pnlEl = el('pnl');
      pnlEl.textContent = (pnl >= 0 ? '+$' : '-$') + fmt(Math.abs(pnl));
      pnlEl.className = 'big ' + (pnl > 0 ? 'green' : pnl < 0 ? 'red' : '');

      const pnlPctEl = el('pnlPct');
      pnlPctEl.textContent = (pnlPctOfMargin >= 0 ? '+' : '-') + fmt(Math.abs(pnlPctOfMargin)) + '%';
      pnlPctEl.className = 'big ' + (pnlPctOfMargin > 0 ? 'green' : pnlPctOfMargin < 0 ? 'red' : '');

      el('finalBalance').textContent = '$' + fmt(finalBalance);

      const pnlIdrEl = el('pnlIdr');
      pnlIdrEl.textContent = (pnlIdr >= 0 ? '+Rp ' : '-Rp ') + fmt(Math.abs(pnlIdr));
      pnlIdrEl.className = 'big ' + (pnlIdr > 0 ? 'green' : pnlIdr < 0 ? 'red' : '');

      const netIdrEl = el('netIdr');
      netIdrEl.textContent = 'Rp ' + fmt(netIdr);
      netIdrEl.className = 'big ' + (netIdr > margin * kurs ? 'green' : 'red');

      el('liqMove').textContent = fmt(liqMove) + '% (approx)';
      el('maint').textContent = 'Estimate only — exchange may have maintenance margin lebih rendah dari initial margin.';
      el('noteOut').textContent = note;
    }

    el('calc').addEventListener('click', calc);
    el('reset').addEventListener('click', ()=>{
      el('margin').value = 1;
      el('leverage').value = 25;
      el('priceChange').value = 10;
      el('side').value = 'long';
      el('kurs').value = 15500;
      el('note').value = '';
      ['notional','pnl','pnlPct','finalBalance','pnlIdr','netIdr','liqMove','maint','noteOut'].forEach(id=>el(id).textContent='-');
    });

    ['margin','leverage','priceChange','kurs'].forEach(id => {
      el(id).addEventListener('keydown', e => { if(e.key === 'Enter') calc(); });
    });

    calc();
  </script>
</body>
</html>